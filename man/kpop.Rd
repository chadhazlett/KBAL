% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{kpop}
\alias{kpop}
\title{Kernel balancing for survey reweighting (kpop).}
\usage{
kpop(
  sample_data,
  population_data,
  base.weights = NULL,
  population.w = NULL,
  cat_data = FALSE,
  mixed_data = FALSE,
  cat_columns = NULL,
  ...
)
}
\arguments{
\item{sample_data}{A data frame or matrix of covariates for the survey
respondents (the units to be reweighted).}

\item{population_data}{A data frame or matrix of covariates for the target
population frame. Must have the same column names as \code{sample_data}.}

\item{base.weights}{Optional positive numeric vector of first-stage
(design) weights for the respondents, of length \code{nrow(sample_data)}.
Passed to \code{kbal()} as \code{base.weights}.}

\item{population.w}{Optional numeric vector of weights for the population
frame units, of length \code{nrow(population_data)}. Defines the target
moments: e.g., pass turnout scores here to target a likely-voter
population rather than the simple unweighted population average.
Passed to \code{kbal()} as \code{population.w}.}

\item{cat_data}{Logical. Set \code{TRUE} if all covariates are categorical.
Passed to \code{kbal()}.}

\item{mixed_data}{Logical. Set \code{TRUE} if covariates include a mix of
categorical and continuous variables. Passed to \code{kbal()}.}

\item{cat_columns}{Character vector of column names that are categorical.
Required when \code{mixed_data = TRUE}. Passed to \code{kbal()}.}

\item{...}{Additional arguments passed to \code{\link{kbal}} (e.g.,
\code{meanfirst}, \code{incrementby}, \code{minnumdims}, \code{maxnumdims},
\code{ebal.tol}, \code{ebal.maxit}).}
}
\value{
The list returned by \code{\link{kbal}}. Weights for the respondents
  are in \code{result$w[1:nrow(sample_data)]}.
}
\description{
A convenience wrapper around \code{\link{kbal}} for the survey
  reweighting use case: weighting a sample of respondents to match a target
  population. Handles the stacking of sample and population data, construction
  of the \code{sampled} indicator, and fixes \code{sampledinpop = FALSE}
  internally, so callers only need to supply the two data frames and any
  weighting or tuning arguments.
}
\examples{
\donttest{
data("lalonde")
set.seed(1)
sample_rows <- lalonde$nsw == 0   # use non-NSW as "respondents"
pop_rows    <- lalonde$nsw == 1   # use NSW as "population"
xvars <- c("age", "black", "educ", "hisp", "married", "re74", "re75")
out <- kpop(sample_data     = lalonde[sample_rows, xvars],
            population_data = lalonde[pop_rows,    xvars],
            mixed_data      = FALSE,
            minnumdims      = 1,
            maxnumdims      = 10)
sample_weights <- out$w[1:sum(sample_rows)]
}
}
