% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/se_functions.R
\name{calc_linearized_var}
\alias{calc_linearized_var}
\title{Linearized variance for a kpop-weighted mean}
\usage{
calc_linearized_var(
  kpop_object,
  outcome,
  row_idx = NULL,
  sample_size = NULL,
  use_1se_lambda = TRUE
)
}
\arguments{
\item{kpop_object}{Object returned by \code{\link{kpop}} or
\code{\link{kbal}}.}

\item{outcome}{Numeric vector of outcomes for the units of interest.
Must already be filtered to non-NA rows; length must equal
\code{length(row_idx)}.}

\item{row_idx}{Integer vector of row positions within the original sample
corresponding to \code{outcome}. Used to select the matching rows of the
kpop object (weight vector, SVD matrix, constraint columns). Defaults to
\code{1:length(outcome)} (all sample units). Does \emph{not} re-index
\code{outcome}.}

\item{sample_size}{Retained for API compatibility; not used in the current
formula (effective \emph{n} is derived from the normalized weights).}

\item{use_1se_lambda}{Logical. If \code{TRUE} (default), uses the
\code{lambda.1se} rule from cross-validation; if \code{FALSE}, uses
\code{lambda.min}.}
}
\value{
Scalar variance of the kpop-weighted mean, or \code{NA_real_} if
  the ridge regression cannot be fit (e.g. near-constant outcome after
  glmnet's internal standardization).
}
\description{
Uses the kernel dimensions stored in the \code{kpop()} output
  to fit a weighted ridge regression of the outcome, then applies a
  sandwich-type linearization that accounts for the fact that the weights
  were estimated rather than fixed. This is the preferred variance estimator
  for kpop-weighted analyses.

  Internally calls \code{glmnet::cv.glmnet} with \code{alpha = 0} (ridge).
  Set a random seed before calling for reproducibility.
}
\seealso{
\code{\link{kpop_summary}}, \code{\link{calc_ses_cat_var}}
}
